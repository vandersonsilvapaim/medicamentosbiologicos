<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Documentação</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">Documentação</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">












<ol class="breadcrumb">
  <li>Interfaces</li>
  <li>ElementListValues</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/components/shared/layout/element-list/element-list.component.ts</code>
        </p>



        <section>
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#pop">pop</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#push">push</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#reset">reset</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#settings">settings</a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section>
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="pop"></a>
                                        <span class="name"><b>pop</b><a href="#pop"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>pop:     <code>literal type[]</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>literal type[]</code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="push"></a>
                                        <span class="name"><b>push</b><a href="#push"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>push:         <code><a href="../classes/ControlBuilder.html" target="_self" >ControlBuilder[][]</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../classes/ControlBuilder.html" target="_self" >ControlBuilder[][]</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="reset"></a>
                                        <span class="name"><b>reset</b><a href="#reset"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>reset:         <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="settings"></a>
                                        <span class="name"><b>settings</b><a href="#settings"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>settings:         <code><a href="../interfaces/ElementListSettings.html" target="_self" >Observable&lt;ElementListSettings&gt;</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../interfaces/ElementListSettings.html" target="_self" >Observable&lt;ElementListSettings&gt;</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Observable, of } from &#x27;rxjs&#x27;;
import {
    debounceTime, delay, distinctUntilChanged, takeWhile
} from &#x27;rxjs/operators&#x27;;

import { SelectionModel } from &#x27;@angular/cdk/collections&#x27;;
import {
    AfterViewInit, Component, EventEmitter, Input, OnDestroy, Output, ViewChild
} from &#x27;@angular/core&#x27;;
import { FormControl, FormGroup } from &#x27;@angular/forms&#x27;;
import { MatPaginator } from &#x27;@angular/material/paginator&#x27;;
import { MatSort } from &#x27;@angular/material/sort&#x27;;
import { MatTable, MatTableDataSource } from &#x27;@angular/material/table&#x27;;

import { ControlBuilder } from &#x27;../../models&#x27;;
import { AlertService } from &#x27;../../services/alert.service&#x27;;
import { LogService } from &#x27;../../services/log.service&#x27;;
import { ChangeDetectionStrategy, ViewEncapsulation } from &#x27;@angular/core&#x27;;

/**
 * dont use if befor this component
 * send value afther onInit
 */
@Component({
    selector: &#x27;element-list&#x27;,
    templateUrl: &#x27;element-list.component.html&#x27;,
    styleUrls: [&#x27;./element-list.component.scss&#x27;],
    preserveWhitespaces: false,
  changeDetection: ChangeDetectionStrategy.OnPush,
  encapsulation: ViewEncapsulation.Emulated
})
export class ElementListComponent implements AfterViewInit, OnDestroy {

    public isLive &#x3D; true;
    private color &#x3D; &#x27;#00000010&#x27;;
    public displayName &#x3D; {};
    public ACTIONS &#x3D; &#x27;actions&#x27;;
    public _displayedColumns &#x3D; [];
    public _columnsToDisplay &#x3D; [this.ACTIONS];
    public _dataSource &#x3D; new MatTableDataSource();
    public _selection &#x3D; new SelectionModel&lt;any&gt;(true, []);
    public show_action_search &#x3D; false;
    public show_action_edit &#x3D; false;
    public show_action_remove &#x3D; false;
    public show_action_radio &#x3D; false;
    public show_action_name &#x3D; &#x27;Ações&#x27;;
    public _consulta_label &#x3D; &#x27;Consulta&#x27;;
    public _consulta_placeholder &#x3D; &#x27;&#x27;;
    public _settings;
    public icons &#x3D; {};

    public displayedColumns &#x3D; {
        pushAll: (datas: ControlBuilder[]) &#x3D;&gt; {
            try {
                if (datas) {
                    this.displayName &#x3D; {};
                    this._columnsToDisplay &#x3D; [];
                    this._displayedColumns &#x3D; [];

                    datas.sort(
                        (a, b) &#x3D;&gt; {
                            if (!(a.favorite)) {
                                return -1;
                            }
                            if (!(b.favorite)) {
                                return 1;
                            }
                            if (a.favorite &lt; b.favorite) {
                                return -1;
                            }
                            if (a.favorite &gt; b.favorite) {
                                return 1;
                            }
                            return 0;
                        });
                    datas.forEach((data) &#x3D;&gt; {
                        this._displayedColumns.push(data.name); // dont change
                        this.displayName[data.name] &#x3D; data.displayed;
                        if (data.favorite !&#x3D; null) {
                            this._columnsToDisplay.push(data.name);
                        }
                    });
                    this._columnsToDisplay.push(this.ACTIONS);
                }
            } catch (error) {
                this.event({ error: error });
            }
        }
    };

    public dataSource &#x3D; {
        getBy: (_filterValue, ...options: string[]) &#x3D;&gt; {
            try {
                let result &#x3D; [];
                if (this._dataSource.data &amp;&amp; options &amp;&amp; _filterValue) {
                    result &#x3D; this._dataSource.data.filter((_value) &#x3D;&gt; {
                        let ret &#x3D; false;
                        options.forEach(option &#x3D;&gt; {
                            const optionValue &#x3D; _value[option];
                            ret &#x3D; ret || optionValue &#x3D;&#x3D;&#x3D; _filterValue;
                        });
                        return ret;
                    });
                }
                return result;
            } catch (error) {
                this.event({ error: error });
            }
        },
        selected: () &#x3D;&gt; this._selection.selected,
        push: (data) &#x3D;&gt; {
            try {
                this._dataSource.data.forEach((row: any) &#x3D;&gt; {
                    if (this._dataSource.data &amp;&amp; row.id &#x3D;&#x3D;&#x3D; data.id) {
                        this.dataSource.pop(data);
                    }
                });
                this._dataSource.data.push(data);
                this._dataSource &#x3D; new MatTableDataSource(this._dataSource.data);
                this._dataSource.paginator &#x3D; this.paginator;
                this._dataSource.sort &#x3D; this.sort;
                this.mattable.dataSource &#x3D; this._dataSource;
                this.mattable.renderRows();
            } catch (error) {
                this.event({ error: error });
            }
        },
        pushAll: (list) &#x3D;&gt; list.forEach((data) &#x3D;&gt; {
            try {
                this._dataSource.data.forEach((row: any) &#x3D;&gt; {
                    if (this._dataSource.data &amp;&amp; row.id &#x3D;&#x3D;&#x3D; data.id) {
                        this.dataSource.pop(data);
                    }
                });
                this._dataSource.data.push(data);
                this._dataSource &#x3D; new MatTableDataSource(this._dataSource.data);
                this._dataSource.paginator &#x3D; this.paginator;
                this._dataSource.sort &#x3D; this.sort;
                this.mattable.dataSource &#x3D; this._dataSource;
                this.mattable.renderRows();
            } catch (error) {
                this.event({ error: error });
            }
        }),
        push_cb: (_controls_builder?: ControlBuilder[]) &#x3D;&gt; {
            try {
                const _l_data &#x3D; this._dataSource.data;
                // tslint:disable-next-line:prefer-const
                let fb: FormGroup &#x3D; new FormGroup({});
                _controls_builder.forEach(c &#x3D;&gt; {
                    fb.addControl(c.name, new FormControl(c.value));
                });

                _l_data.forEach((row: any) &#x3D;&gt; {
                    if (this._dataSource.data &amp;&amp; row.id &#x3D;&#x3D;&#x3D; fb.controls.id.value) {
                        this.dataSource.pop(row);
                    }
                });

                this._dataSource.data.push(fb.value);
                this._dataSource &#x3D; new MatTableDataSource(this._dataSource.data);
                this._dataSource.paginator &#x3D; this.paginator;
                this._dataSource.sort &#x3D; this.sort;
                this.mattable.dataSource &#x3D; this._dataSource;
                this.mattable.renderRows();
            } catch (error) {
                this.event({ error: error });
            }
        },
        pushAll_cb: (_controls_builders: ControlBuilder[][]) &#x3D;&gt; {
            try {
                if (_controls_builders) {
                    _controls_builders.forEach(_controls_builder &#x3D;&gt; {
                        const _l_data &#x3D; this._dataSource.data;
                        // tslint:disable-next-line:prefer-const
                        let fb: FormGroup &#x3D; new FormGroup({});
                        _controls_builder.forEach(c &#x3D;&gt; {
                            fb.addControl(c.name, new FormControl(c.value));
                        });

                        _l_data.forEach((row: any) &#x3D;&gt; {
                            if (this._dataSource.data &amp;&amp; row.id &#x3D;&#x3D;&#x3D; fb.controls.id.value) {
                                this.dataSource.pop(row);
                            }
                        });

                        this._dataSource.data.push(fb.value);
                        this._dataSource &#x3D; new MatTableDataSource(this._dataSource.data);
                        this._dataSource.paginator &#x3D; this.paginator;
                        this._dataSource.sort &#x3D; this.sort;
                        this.mattable.dataSource &#x3D; this._dataSource;
                        this.mattable.renderRows();
                    });
                }
            } catch (error) {
                this.event({ error: error });
            }
        },
        pop: (data) &#x3D;&gt; {
            try {
                if (data &amp;&amp; this._dataSource.data) {
                    let result &#x3D; [];
                    result &#x3D; this._dataSource.data.filter((_value: any) &#x3D;&gt; {
                        let ret &#x3D; false;
                        ret &#x3D; ret || _value.id !&#x3D;&#x3D; data.id;
                        return ret;
                    });
                    this._dataSource &#x3D; new MatTableDataSource(result);
                    this._dataSource.paginator &#x3D; this.paginator;
                    this._dataSource.sort &#x3D; this.sort;
                    this.mattable.dataSource &#x3D; this._dataSource;
                    this.mattable.renderRows();
                }
            } catch (error) {
                this.event({ error: error });
            }
        },
        reset: () &#x3D;&gt; {
            try {
                // this.show_action_search &#x3D; false;
                // this.show_action_edit &#x3D; false;
                // this.show_action_remove &#x3D; false;
                // this.show_action_radio &#x3D; false;
                this._displayedColumns &#x3D; [];
                this.displayName &#x3D; {};
                this._columnsToDisplay &#x3D; [this.ACTIONS];

                this._selection &#x3D; new SelectionModel&lt;any&gt;(true, []);
                this._dataSource &#x3D; new MatTableDataSource();
                this.mattable.dataSource &#x3D; this._dataSource;
                this.mattable.renderRows();
            } catch (error) {
                this.event({ error: error });
            }
        }
    };


    constructor(public log: LogService, public alert: AlertService) { }

    @ViewChild(MatPaginator) public paginator: MatPaginator;
    @ViewChild(MatSort) public sort: MatSort;
    @ViewChild(MatTable) public mattable: MatTable&lt;any&gt;;
    @Output() public action &#x3D; new EventEmitter&lt;ElementListEvents&gt;();

    @Input() public set values(_values: Observable&lt;any&gt;) {
        // TODO remover @view´s e usar input
        if (_values) {
            _values.pipe(
            ).subscribe((_v: ElementListValues) &#x3D;&gt; {
                try {

                    if (_v) {

                        if (_v.push) {
                            if (_v.push.length &gt; 0) {
                                if (this._dataSource.data.length &lt; 1) {
                                    this.displayedColumns.pushAll(_v.push[0]);
                                }

                                _v.push.forEach((_pu) &#x3D;&gt; {
                                  const indexIconsRow &#x3D; _pu.findIndex(v &#x3D;&gt; v.name &#x3D;&#x3D;&#x3D; &#x27;icons&#x27;);
                                  if(indexIconsRow &gt;&#x3D; 0){
                                    const iconsRow &#x3D; _pu[indexIconsRow];
                                    const id &#x3D; window.btoa(iconsRow.value);
                                    if(iconsRow &amp;&amp; (!this.icons || !this.icons[id])){
                                      this.icons[id] &#x3D; JSON.parse(iconsRow.value);
                                    }
                                    _pu[indexIconsRow].value &#x3D; id;
                                  }
                                  this.dataSource.push_cb(_pu);
                                });
                            } else {
                                this.dataSource.reset();
                            }
                        }

                        if (_v.pop) {
                            if (_v.pop.length &gt; 0) {
                                _v.pop.forEach((_p) &#x3D;&gt; this.dataSource.pop(_p));
                            } else {
                                this.dataSource.reset();
                            }
                        }

                        if (_v.reset) {
                            this.dataSource.reset();
                            if (_v.reset !&#x3D;&#x3D; true &amp;&amp; _v.reset.length &gt; 0) {
                                if (this._dataSource.data.length &lt; 1) {
                                    this.displayedColumns.pushAll(_v.reset[0]);
                                }
                                _v.reset.forEach((_pu) &#x3D;&gt; this.dataSource.push_cb(_pu));
                            }
                        }

                        if (_v.settings) {
                            this.settings &#x3D; _v.settings;
                        }

                    }

                } catch (error) {
                    this.event({ error: error });
                }
            });
        }
    }

    @Input() public set settings(_settings: Observable&lt;ElementListSettings&gt;) {
        if (_settings) {
            _settings.pipe(
            ).subscribe(
                (s: ElementListSettings) &#x3D;&gt; {
                    try {
                        if (s) {
                            this._settings &#x3D; s;
                            if (this._settings.show_action) {
                                this.show_action_search &#x3D; this._settings.show_action.search;
                                this.show_action_edit &#x3D; this._settings.show_action.edit;
                                this.show_action_remove &#x3D; this._settings.show_action.remove;
                                this.show_action_radio &#x3D; this._settings.show_action.radio;
                                this.show_action_name &#x3D; this._settings.show_action.name;
                                this._consulta_placeholder &#x3D; this._settings.show_action.consulta_placeholder;
                                this._consulta_label &#x3D; this._settings.show_action.consulta_label;
                            }
                        }
                    } catch (error) {
                        this.event({ error: error });
                    }
                }
            );
        }
    }

    /** Whether the number of selected elements matches the total number of rows. */
    public isAllSelected() {
        const numSelected &#x3D; this._selection.selected.length;
        const numRows &#x3D; this._dataSource.data.length;
        return numSelected &#x3D;&#x3D;&#x3D; numRows;
    }

    /** Selects all rows if they are not all selected; otherwise clear selection. */
    public masterToggle() {
        this.isAllSelected() ?
            this._selection.clear() :
            this._dataSource.data.forEach(row &#x3D;&gt; this._selection.select(row));
    }

    // public isLoadingResults() {
    //     const _data_source: any &#x3D; this.mattable ? this.mattable.dataSource : null;
    //     return _data_source &amp;&amp; _data_source.data &amp;&amp; _data_source.data.length &lt; 1;

    // }

    public removeRow(row?) {
        const _rows &#x3D; row ? row : this._selection.selected;
        if (_rows &amp;&amp; this.show_action_remove) {
            _rows.forEach(r &#x3D;&gt; this.dataSource.pop(r));
            this.event({ remove: _rows });
        } else {
            this.alert.showToaster(AlertService.MSG_LIST._23_SELECT_DEL);
        }
    }

    public editRow(row) {
        window.performance.mark(&#x27;mark_editRow&#x27;);
        if (row &amp;&amp; this.show_action_edit) {
            this.event({ edit: row });
        } else {
            this.alert.showToaster(AlertService.MSG_LIST._24_SELECT_EDIT);
        }
    }

    public viewRow(row) {
        if (row &amp;&amp; this.show_action_search) {
            this.event({ view: row });
        } else {
            this.alert.showToaster(AlertService.MSG_LIST._25_SELECT_VIEW);
        }
    }

    public event(event: ElementListEvents) {
        if (event &amp;&amp; this.isLive) {
            this.action.emit(event);
        }
    }

    getAll() {
        if (this._dataSource) {
            this.event({ getAll: this._dataSource.data });
        }
    }

    changeRadioSelection(event) {

    }

    ngAfterViewInit(): void {
    }

    public ngOnDestroy(): void {
        this.isLive &#x3D; false;
        this.alert.clearAll();
    }

    public applyFilter(_filterValue) {
        try {
            this._dataSource.filter &#x3D; _filterValue.value.trim().toLowerCase();
            if (this._dataSource.paginator) {
                this._dataSource.paginator.firstPage();
            }
            if (this._dataSource.filteredData &amp;&amp; this._dataSource.filteredData.length &#x3D;&#x3D;&#x3D; 0) {
                of(this._dataSource.filter).pipe(
                    takeWhile(() &#x3D;&gt; this.isLive),
                    delay(100),
                    debounceTime(200),
                    distinctUntilChanged(),
                ).subscribe(value &#x3D;&gt; {
                    this.event({ filteredData: value });
                });
            }
        } catch (error) {
            this.event({ error: error });
        }
    }
}

export interface ElementListSettings {
    show_action: {
        search?: boolean;
        edit?: boolean;
        remove?: boolean;
        radio?: boolean;
        name?: string;
        consulta_placeholder?: string;
        consulta_label?: string;
    };
}

export interface ElementListValues {
    push?: ControlBuilder[][];
    pop?: { id?: string }[];
    reset?: any;
    settings?: Observable&lt;ElementListSettings&gt;;
}

export interface ElementListEvents {
    filteredData?: any;
    remove?: any;
    view?: any;
    edit?: any;
    getAll?: any;
    error?: any;
}
</code></pre>
    </div>
</div>


                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'ElementListValues.html';
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
